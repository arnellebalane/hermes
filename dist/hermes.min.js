"use strict";!function(e,n){"function"==typeof define&&define.amd?define([],n):e.hermes=n()}(window,function(){function e(e,n){e in o||(o[e]=[]),o[e].push(n)}function n(e,n){if(e in o){if("function"==typeof n){var t=o[e].indexOf(n);o[e].splice(t,1)}"function"==typeof n&&0!==o[e].length||delete o[e]}}function t(e,n){e in o&&o[e].forEach(function(e){return e(n)})}var o={};return"BroadcastChannel"in window?function(){function o(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r.postMessage({topic:e,data:n}),o&&t(e,n)}var r=new BroadcastChannel("hermes");return r.onmessage=function(e){return t(e.data.topic,e.data.data)},{on:e,off:n,send:o}}():"SharedWorker"in window?function(){function o(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s.port.postMessage({topic:e,data:n}),o&&t(e,n)}var r=document.querySelector('[src$="hermes.js"],[src$="hermes.min.js"]'),i=new URL(r.src),a=i.pathname.replace(/hermes(\.min)?\.js/,"hermes-worker$1.js"),s=new SharedWorker(a,"hermes");return s.port.start(),s.port.onmessage=function(e){return t(e.data.topic,e.data.data)},{on:e,off:n,send:o}}():"localStorage"in window?function(){function o(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=i+e;null===r.getItem(s)||""===r.getItem(s)?(r.setItem(s,JSON.stringify(n)),r.removeItem(s),o&&t(e,n)):(s in a||(a[s]=[]),a[s].push(n))}var r=window.localStorage,i="__hermes:",a={};return window.addEventListener("storage",function(e){if(e.key&&0===e.key.indexOf(i)&&(null===e.oldValue||""===e.oldValue)){t(e.key.replace(i,""),JSON.parse(e.newValue))}}),window.addEventListener("storage",function(e){if(e.key&&0===e.key.indexOf(i)&&(null===e.newValue||""===e.newValue)){var n=e.key.replace(i,"");n in a&&(o(n,a[n].shift()),0===a[n].length&&delete a[n])}}),{on:e,off:n,send:o}}():function(){function e(){console.warn("Hermes messaging is not supported.")}return{on:e,off:e,send:e}}()});